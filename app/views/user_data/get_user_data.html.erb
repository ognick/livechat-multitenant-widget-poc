<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Get User Data</title>
</head>
<body>
<script>
    const urlParams = new URLSearchParams(window.location.search);
    const hash = window.location.hash;
    const hashMatch = hash.match(/access_token=([^&]+)/);
    
    const params = new URLSearchParams(window.location.search);
    if (hashMatch && hashMatch[1]) {
        params.append('token', decodeURIComponent(hashMatch[1]));
    }
    
    fetch('/get-user-data.json?' + params.toString())
        .then(response => response.json())
        .then(data => {
            if (window.opener && !window.opener.closed) {
                window.opener.postMessage(data, '*');
            }
        });
</script>
</body>
</html>
